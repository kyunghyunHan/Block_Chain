# BlockChain

- Rust로 블록체인 구현 해보기

## 블록체인 개요
### RSA와 비대칭 암호화
- PKI 공개키 인프라: 공개키 암호화 방식으로, RSA 알고리즘은 가장 대표적인 예입니다.
- 소인수분해 문제: 큰 수의 소인수분해가 매우 어려워 양자 컴퓨터가 등장하기 전까지 대부분의 암호화 시스템에서 중요한 역할을 했습니다.
비대칭키 암호화: 공개키로 암호화하고, 개인키로 복호화하여 보안성을 제공합니다.
- RSA-2048: 인터넷 뱅킹에서 주로 사용되는 안전한 암호화 방식입니다.
### 비트코인과 블록체인에서의 암호화
- ECDSA (Elliptic Curve Digital Signature Algorithm): 비트코인에서 사용되는 서명 알고리즘으로 익명성과 부인방지를 제공합니다.

- 위변조 방지: 거래 내역을 해시하여 위변조를 방지합니다
- ECC (Elliptic Curve Cryptography): RSA보다 더 작은 키 사이즈로 비슷한 보안성을 제공, 비트코인은 secp256k1 타원곡선을 사용합니다.

### 비트코인 주소와 해시
- 주소 생성: 공개키를 해싱하여 비트코인 주소를 생성합니다.
- 단방향 해시: 일정한 임의의 256비트 해시 값을 생성하며, 이는 SHA-256과 같은 단방향 해시 알고리즘을 사용합니다.

## 블록체인 및 트랜잭션 처리

### 블록 검증
1. 새로운 블록 수신: 블록 구조, 해시, 타임스탬프 등을 검증합니다.
2. 트랜잭션 검증: 입력 및 출력 목록 확인, 더블 스펜딩 방지, UTXO 검증 등을 수행합니다.
3. 블록 크기 제한: 블록 크기 제한 (예: 1MB)을 준수합니다.
### 트랜잭션 전파

1. 트랜잭션 수신: 다른 노드로부터 트랜잭션을 받아 검증 후 전파합니다.
2. 새로운 트랜잭션 전파: 모든 노드에 트랜잭션을 전파하여 네트워크에 확산시킵니다.

### 블록 생성
1. 트랜잭션 선택: Mempool에서 미처리된 트랜잭션을 선택합니다.
2. Coinbase 트랜잭션 생성: 새로운 블록의 보상 트랜잭션을 생성합니다.
3. 블록 헤더 생성: Merkle 루트, 이전 블록 해시 등을 포함한 블록 헤더를 만듭니다.
4. Nonce 찾기: Proof of Work를 통해 난이도에 맞는 nonce 값을 찾습니다.

### UTXO (Unspent Transaction Output)
- 아직 사용되지 않은 트랜잭션의 출력은 UTXO로 분류됩니다. 이를 통해 자산의 유효성을 확인할 수 있습니다.

## 비트코인 거래 방식

1. P2PK: 공개키를 사용하는 거래 방식.
2. P2PKH: 공개키 해시를 사용하는 거래 방식.
3. Null Data: 데이터를 블록체인에 저장하는 방식으로, OP_RETURN을 사용합니다.
4. SegWit: 트랜잭션 크기 문제를 해결하고, 트랜잭션 변조 문제를 해결한 새로운 거래 형식입니다.
5. TapRoot: 비트코인에서 새로운 서명 방식인 슈노르 서명을 도입한 업그레이드로, 공동 서명과 MAST(Merkelized Abstract Syntax Tree) 지원을 통해 프라이버시 및 효율성을 높입니다.
  
## 네트워크와 합의 알고리즘

### Lightning Network:
비트코인의 레이어 2 기술로, 온체인 블록을 사용하지 않고 거래를 처리하여 실시간으로 빠르고 저렴한 결제를 가능하게 합니다.
### BFT (Byzantine Fault Tolerance):
분산 시스템에서 일부 장애가 발생하더라도 시스템이 정상적으로 동작할 수 있도록 하는 알고리즘입니다.
### PBFT (Practical Byzantine Fault Tolerance): 블록체인에서 합의 알고리즘으로 사용됩니다.
### Proof of Work (PoW):
컴퓨팅 파워를 사용하여 새로운 블록을 생성하고 거래 위변조를 방지하는 방법입니다. 마이닝을 통해 nonce 값을 찾으며, 난이도는 네트워크 해시 속도에 따라 조정됩니다.


## 채굴 및 네트워크 공격
### 51% 공격:
공격자가 네트워크 해시의 51%를 차지하면, 더 긴 체인을 만들 수 있고, 이를 통해 더블 스펜딩 공격 등을 수행할 수 있습니다.
### Sybil Attack:
공격자가 많은 수의 노드를 운영하여 네트워크를 방해하거나 잘못된 데이터를 퍼뜨리는 공격입니다.
### Longest Chain Rule:
여러 블록체인이 발생했을 때, 가장 긴 체인을 유효한 체인으로 간주하는 규칙입니다.

## 블록체인 보관 및 관리

### Mempool:
아직 블록에 포함되지 않은 트랜잭션을 관리하는 영역입니다. 채굴자는 Mempool에서 트랜잭션을 선택하여 새로운 블록에 포함시킵니다.
### LevelDB:
비트코인에서 블록체인 데이터를 저장하는 경량 데이터베이스로, 빠른 읽기/쓰기 성능을 제공합니다.
### Fork:
Hard Fork와 Soft Fork가 있으며, 네트워크 업그레이드가 분리될 때 사용됩니다. Hard Fork는 업그레이드가 필수이며, 네트워크 분리가 발생할 수 있습니다.

## 비트코인 지갑
1. Hardware Wallet:

- 물리적 장치로 개인키를 안전하게 저장합니다. 고액 자산가들이 주로 사용합니다.
- 삼성 월렛: TEE(Trusted Execution Environment)에서 개인키를 안전하게 보관합니다.
2. Cold vs Hot Wallet:
- Cold Wallet: 인터넷에 연결되지 않은 오프라인 지갑.
Hot Wallet: 인터넷에 연결된 지갑으로, 해킹에 취약할 수 있습니다.
3. SPV (Simplified Payment Verification):

- 전체 블록체인 데이터를 다운로드하지 않고, 필요한 정보를 추출하여 트랜잭션을 검증하는 방식입니다. 모바일 기기나 IoT 기기에서 사용됩니다.


## 블록체인의 한계점 및 대안
- 비트코인의 한계: 높은 에너지 소비, 느린 처리 속도, 제한적인 기능과 익명성.
- 대안 블록체인:
Ripple: 은행 간의 거래를 위한 프로토콜.
Solana: 빠른 성능과 낮은 수수료를 제공하는 블록체인.
Fabric: 기업용 블록체인 솔루션.

## 비트코인 네트워크 명령어 예시
```
# 블록체인 예시 실행
RUST_LOG=info cargo run --example gen_bc --quiet

# 블록 데이터 요청
{"Blocks":""}

# 새로운 지갑 생성
{"CreateWallet":"justin"}

# 트랜잭션 생성
{"Trans": {"from":"1KooomKwhgPCfB2YfnKT7yMUxGcVWqS3ns","to":"1EuM1UEhJFTDR5UfWzfghzv82bCdwRWk9E","amount":"4"}}

```
